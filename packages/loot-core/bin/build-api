#!/bin/bash -e

cd `dirname "$0"`
ROOT=`pwd -P`

OUTPATH="$ROOT/../../api/app"
OUTFMT="[dir]/bundle.api"
EXTENSIONS=".api.js,.api.ts,.api.tsx,.electron.js,.electron.ts,.electron.tsx,.js,.ts,.tsx,.json"

echo "Building into api package"
(cd .. ; OUTPATH=$OUTPATH OUTFMT=$OUTFMT EXTENSIONS=$EXTENSIONS node build.mjs)
echo "Copying Migrations"
(cd .. ; ./bin/copy-migrations ../api)
echo "Done!"
