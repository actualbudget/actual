---
category: Features
authors: [augustopinheiro]
---

Add INVESTMENT account support for Pluggy.ai integration

This PR extends Pluggy.ai bank sync to support INVESTMENT accounts in addition to existing BANK and CREDIT accounts. Investment accounts from Brazilian institutions are now consolidated into a single "Investimentos" account per institution, showing the total balance across all individual investments (CDBs, funds, etc.).

**Key Changes:**
- Added `getInvestmentsByItemId` method to pluggyai-service.js with fallback to direct API calls
- Extended `/accounts` endpoint to fetch and consolidate investment data
- Enhanced `/transactions` endpoint to handle investment account transactions with proper UUID validation
- Updated frontend CreateAccountModal.tsx to correctly calculate investment balances using `investmentData?.totalBalance`
- Added comprehensive logging for debugging investment data processing

**Technical Details:**
- Investment accounts use ID format `investment-{itemId}-all` for consolidated accounts
- Proper balance conversion and number validation to prevent NaN issues
- UUID validation for itemIds with graceful fallback for non-UUID formats
- Consolidated account creation that sums all individual investment balances

This enables Brazilian users to track their complete investment portfolio through Actual Budget's Pluggy.ai integration. 